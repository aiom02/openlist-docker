# OpenList å®å¡”é¢æ¿éƒ¨ç½²æ•™ç¨‹

> ðŸŽ¯ **æœ€é€‚åˆæ–°æ‰‹çš„éƒ¨ç½²æ–¹æ¡ˆ**  
> å›¾å½¢åŒ–ç•Œé¢ï¼Œç®€å•æ˜“ç”¨ï¼Œæ— éœ€å‘½ä»¤è¡Œæ“ä½œ

---

## ðŸ“‹ ç›®å½•

1. [å‡†å¤‡å·¥ä½œ](#å‡†å¤‡å·¥ä½œ)
2. [å®‰è£…å®å¡”é¢æ¿](#å®‰è£…å®å¡”é¢æ¿)
3. [é…ç½®å®å¡”çŽ¯å¢ƒ](#é…ç½®å®å¡”çŽ¯å¢ƒ)
4. [éƒ¨ç½²åŽç«¯æœåŠ¡](#éƒ¨ç½²åŽç«¯æœåŠ¡)
5. [éƒ¨ç½²å‰ç«¯æœåŠ¡](#éƒ¨ç½²å‰ç«¯æœåŠ¡)
6. [é…ç½®åŸŸåå’ŒHTTPS](#é…ç½®åŸŸåå’Œhttps)
7. [æ—¥å¸¸ç»´æŠ¤](#æ—¥å¸¸ç»´æŠ¤)

---

## ðŸ“¦ å‡†å¤‡å·¥ä½œ

### 1. æœåŠ¡å™¨è¦æ±‚

- **æ“ä½œç³»ç»Ÿ**: Ubuntu 20.04+ / CentOS 7+ / Debian 10+
- **å†…å­˜**: è‡³å°‘ 512MBï¼ˆæŽ¨è 1GB+ï¼‰
- **ç£ç›˜**: è‡³å°‘ 10GB å¯ç”¨ç©ºé—´
- **å¸¦å®½**: è‡³å°‘ 1Mbps

### 2. æœ¬åœ°ç¼–è¯‘æ–‡ä»¶

åœ¨éƒ¨ç½²å‰ï¼Œéœ€è¦åœ¨æœ¬åœ°å‡†å¤‡å¥½ç¼–è¯‘æ–‡ä»¶ï¼š

#### Windows ä¸Šç¼–è¯‘åŽç«¯ï¼ˆäº¤å‰ç¼–è¯‘åˆ° Linuxï¼‰

```powershell
# æ‰“å¼€ PowerShellï¼Œè¿›å…¥åŽç«¯ç›®å½•
cd OpenList-main

# è®¾ç½®äº¤å‰ç¼–è¯‘çŽ¯å¢ƒå˜é‡
$env:GOOS="linux"
$env:GOARCH="amd64"
$env:CGO_ENABLED=0

# ç¼–è¯‘
go build -o openlist main.go

# æ£€æŸ¥ç¼–è¯‘ç»“æžœ
ls openlist
```

#### æž„å»ºå‰ç«¯

```powershell
# è¿›å…¥å‰ç«¯ç›®å½•
cd OpenList-Frontend-main

# å®‰è£…ä¾èµ–ï¼ˆé¦–æ¬¡éœ€è¦ï¼‰
pnpm install

# æž„å»ºç”Ÿäº§ç‰ˆæœ¬
pnpm run build

# æž„å»ºå®ŒæˆåŽä¼šç”Ÿæˆ dist ç›®å½•
ls dist
```

### 3. æ–‡ä»¶æ¸…å•

å‡†å¤‡å¥½ä»¥ä¸‹æ–‡ä»¶ï¼š
- âœ… `openlist` - åŽç«¯å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆLinux ç‰ˆæœ¬ï¼‰
- âœ… `dist/` - å‰ç«¯æž„å»ºæ–‡ä»¶å¤¹ï¼ˆåŒ…å« index.html ç­‰ï¼‰

---

## ðŸš€ å®‰è£…å®å¡”é¢æ¿

### æ–¹æ³•ä¸€ï¼šSSH å‘½ä»¤è¡Œå®‰è£…ï¼ˆæŽ¨èï¼‰

#### Ubuntu/Deepin ç³»ç»Ÿ

```bash
wget -O install.sh https://download.bt.cn/install/install-ubuntu_6.0.sh
sudo bash install.sh ed8484bec
```

#### CentOS ç³»ç»Ÿ

```bash
yum install -y wget && wget -O install.sh https://download.bt.cn/install/install_6.0.sh
sh install.sh ed8484bec
```

#### Debian ç³»ç»Ÿ

```bash
wget -O install.sh https://download.bt.cn/install/install-ubuntu_6.0.sh
bash install.sh ed8484bec
```

### å®‰è£…å®ŒæˆåŽ

å®‰è£…å®Œæˆä¼šæ˜¾ç¤ºï¼š

```
==================================================================
Congratulations! Installed successfully!
==================================================================
å¤–ç½‘é¢æ¿åœ°å€: http://YOUR_IP:8888/xxxxxxxx
å†…ç½‘é¢æ¿åœ°å€: http://YOUR_IP:8888/xxxxxxxx
username: xxxxxxxx
password: xxxxxxxx
If you cannot access the panel,
release the following panel port [8888] in the security group
==================================================================
```

> âš ï¸ **é‡è¦**: è¯·ä¿å­˜å¥½é¢æ¿åœ°å€ã€ç”¨æˆ·åå’Œå¯†ç ï¼

### æ–¹æ³•äºŒï¼šäº‘æœåŠ¡å•†ä¸€é”®å®‰è£…

å¤§éƒ¨åˆ†äº‘æœåŠ¡å•†ï¼ˆé˜¿é‡Œäº‘ã€è…¾è®¯äº‘ç­‰ï¼‰çš„é•œåƒå¸‚åœºéƒ½æä¾›å®å¡”é¢æ¿é•œåƒï¼š

1. è´­ä¹°æœåŠ¡å™¨æ—¶ï¼Œé€‰æ‹©"é•œåƒå¸‚åœº"
2. æœç´¢"å®å¡”é¢æ¿"
3. é€‰æ‹©å®˜æ–¹é•œåƒ
4. è´­ä¹°åŽè‡ªåŠ¨å®‰è£…å®Œæˆ

---

## âš™ï¸ é…ç½®å®å¡”çŽ¯å¢ƒ

### 1. ç™»å½•å®å¡”é¢æ¿

1. æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—®: `http://ä½ çš„æœåŠ¡å™¨IP:8888`
2. è¾“å…¥å®‰è£…æ—¶æ˜¾ç¤ºçš„ç”¨æˆ·åå’Œå¯†ç 
3. é¦–æ¬¡ç™»å½•éœ€è¦ç»‘å®šå®å¡”è´¦å·ï¼ˆå¯è·³è¿‡ï¼‰

### 2. å®‰è£…åŸºç¡€çŽ¯å¢ƒ

é¦–æ¬¡ç™»å½•ä¼šå¼¹å‡º"æŽ¨èå®‰è£…å¥—ä»¶"ï¼Œé€‰æ‹©ï¼š

#### æ–¹æ¡ˆ Aï¼šæœ€å°åŒ–å®‰è£…ï¼ˆæŽ¨èï¼‰

åªå®‰è£…å¿…è¦ç»„ä»¶ï¼š
- âœ… **Nginx** 1.22+ ï¼ˆé€‰æ‹©"æžé€Ÿå®‰è£…"ï¼‰
- âŒ PHPï¼ˆä¸éœ€è¦ï¼‰
- âŒ MySQLï¼ˆä¸éœ€è¦ï¼ŒOpenList è‡ªå¸¦ SQLiteï¼‰
- âŒ phpMyAdminï¼ˆä¸éœ€è¦ï¼‰

#### æ–¹æ¡ˆ Bï¼šå®Œæ•´å®‰è£…

å¦‚æžœæœåŠ¡å™¨è¿˜è¦è¿è¡Œå…¶ä»– PHP é¡¹ç›®ï¼š
- âœ… Nginx 1.22+
- âœ… PHP 7.4+
- âœ… MySQL 5.7+

ç‚¹å‡»"ä¸€é”®å®‰è£…"ï¼Œç­‰å¾…çº¦ 5-10 åˆ†é’Ÿã€‚

### 3. é…ç½®å®‰å…¨ç»„å’Œé˜²ç«å¢™

#### åœ¨å®å¡”é¢æ¿ä¸­ï¼š

1. å·¦ä¾§èœå• â†’ **å®‰å…¨**
2. æ·»åŠ ä»¥ä¸‹ç«¯å£ï¼š
   - `80` - HTTP
   - `443` - HTTPS
   - `5244` - OpenList åŽç«¯ï¼ˆå¯é€‰ï¼Œå»ºè®®åªå…è®¸æœ¬åœ°è®¿é—®ï¼‰

#### åœ¨äº‘æœåŠ¡å•†æŽ§åˆ¶å°ï¼š

- é˜¿é‡Œäº‘ï¼š**äº‘æœåŠ¡å™¨ ECS** â†’ **å®‰å…¨ç»„** â†’ æ·»åŠ è§„åˆ™
- è…¾è®¯äº‘ï¼š**äº‘æœåŠ¡å™¨** â†’ **å®‰å…¨ç»„** â†’ æ·»åŠ è§„åˆ™
- å¼€æ”¾ç«¯å£ï¼š80ã€443

---

## ðŸ”§ éƒ¨ç½²åŽç«¯æœåŠ¡

### 1. ä¸Šä¼ åŽç«¯æ–‡ä»¶

#### æ–¹æ³•ä¸€ï¼šé€šè¿‡å®å¡”é¢æ¿ä¸Šä¼ 

1. å·¦ä¾§èœå• â†’ **æ–‡ä»¶**
2. è¿›å…¥ `/opt` ç›®å½•ï¼ˆå¦‚æžœæ²¡æœ‰å°±åˆ›å»ºï¼‰
3. ç‚¹å‡»"æ–°å»ºç›®å½•" â†’ è¾“å…¥ `openlist`
4. è¿›å…¥ `/opt/openlist/` ç›®å½•
5. ç‚¹å‡»"ä¸Šä¼ " â†’ é€‰æ‹©æœ¬åœ°çš„ `openlist` æ–‡ä»¶
6. ä¸Šä¼ å®ŒæˆåŽï¼Œé€‰ä¸­æ–‡ä»¶ï¼Œç‚¹å‡»"æƒé™" â†’ è®¾ç½®ä¸º `755`

#### æ–¹æ³•äºŒï¼šé€šè¿‡ SSH ä¸Šä¼ ï¼ˆæ›´å¿«ï¼‰

```bash
# åœ¨æœ¬åœ° PowerShell ä¸­æ‰§è¡Œ
scp openlist root@ä½ çš„æœåŠ¡å™¨IP:/opt/openlist/
```

### 2. åˆ›å»ºç›®å½•ç»“æž„

åœ¨å®å¡”é¢æ¿ **æ–‡ä»¶ç®¡ç†** ä¸­ï¼Œåˆ›å»ºä»¥ä¸‹ç›®å½•ï¼š

```
/opt/openlist/
â”œâ”€â”€ openlist          # åŽç«¯å¯æ‰§è¡Œæ–‡ä»¶
â”œâ”€â”€ data/             # æ•°æ®ç›®å½•ï¼ˆæ–°å»ºï¼‰
â”‚   â”œâ”€â”€ temp/         # ä¸´æ—¶æ–‡ä»¶ï¼ˆæ–°å»ºï¼‰
â”‚   â””â”€â”€ log/          # æ—¥å¿—ç›®å½•ï¼ˆæ–°å»ºï¼‰
â””â”€â”€ public/           # å‰ç«¯æ–‡ä»¶ï¼ˆç¨åŽä¸Šä¼ ï¼‰
    â””â”€â”€ dist/
```

**å¿«é€Ÿåˆ›å»º**ï¼šåœ¨å®å¡”ç»ˆç«¯æ‰§è¡Œ

```bash
mkdir -p /opt/openlist/data/temp
mkdir -p /opt/openlist/data/log
mkdir -p /opt/openlist/public/dist
chmod +x /opt/openlist/openlist
```

### 3. åˆ›å»ºé…ç½®æ–‡ä»¶

åœ¨ `/opt/openlist/data/` ç›®å½•ä¸‹ï¼Œæ–°å»ºæ–‡ä»¶ `config.json`ï¼š

```json
{
  "force": false,
  "address": "0.0.0.0",
  "port": 5244,
  "assets": "/opt/openlist/public/dist",
  "database": {
    "type": "sqlite3",
    "host": "",
    "port": 0,
    "user": "",
    "password": "",
    "name": "",
    "db_file": "/opt/openlist/data/data.db",
    "table_prefix": "x_",
    "ssl_mode": "",
    "dsn": ""
  },
  "scheme": {
    "https": false,
    "cert_file": "",
    "key_file": ""
  },
  "temp_dir": "/opt/openlist/data/temp",
  "log": {
    "enable": true,
    "name": "/opt/openlist/data/log/log.log",
    "max_size": 50,
    "max_backups": 30,
    "max_age": 28,
    "compress": false
  }
}
```

**æ“ä½œæ­¥éª¤**ï¼š
1. åœ¨å®å¡”æ–‡ä»¶ç®¡ç†ä¸­ï¼Œè¿›å…¥ `/opt/openlist/data/`
2. ç‚¹å‡»"æ–°å»ºæ–‡ä»¶" â†’ æ–‡ä»¶åè¾“å…¥ `config.json`
3. ç‚¹å‡»æ–‡ä»¶åæ‰“å¼€ç¼–è¾‘å™¨
4. ç²˜è´´ä¸Šé¢çš„å†…å®¹
5. ç‚¹å‡»"ä¿å­˜"

### 4. åˆ›å»ºç³»ç»ŸæœåŠ¡ï¼ˆå®ˆæŠ¤è¿›ç¨‹ï¼‰

#### æ–¹æ³•ä¸€ï¼šä½¿ç”¨å®å¡”çš„"è½¯ä»¶å•†åº—"å®‰è£…"è¿›ç¨‹å®ˆæŠ¤ç®¡ç†å™¨"

1. å·¦ä¾§èœå• â†’ **è½¯ä»¶å•†åº—**
2. æœç´¢"è¿›ç¨‹å®ˆæŠ¤"æˆ–"Supervisor"
3. ç‚¹å‡»"å®‰è£…"
4. å®‰è£…å®ŒæˆåŽï¼Œç‚¹å‡»"è®¾ç½®"
5. ç‚¹å‡»"æ·»åŠ å®ˆæŠ¤è¿›ç¨‹"ï¼Œå¡«å†™ï¼š
   - **åç§°**: `openlist`
   - **è¿è¡Œç›®å½•**: `/opt/openlist`
   - **å¯åŠ¨å‘½ä»¤**: `/opt/openlist/openlist server`
   - **è¿›ç¨‹æ•°é‡**: `1`
6. ç‚¹å‡»"ç¡®å®š"
7. ç‚¹å‡»"å¯åŠ¨"

#### æ–¹æ³•äºŒï¼šä½¿ç”¨ systemdï¼ˆæŽ¨èï¼‰

åœ¨å®å¡” **ç»ˆç«¯** ä¸­æ‰§è¡Œï¼š

```bash
# åˆ›å»º systemd æœåŠ¡æ–‡ä»¶
cat > /etc/systemd/system/openlist.service << 'EOF'
[Unit]
Description=OpenList Service
After=network.target

[Service]
Type=simple
User=root
WorkingDirectory=/opt/openlist
ExecStart=/opt/openlist/openlist server
Restart=on-failure
RestartSec=5s
LimitNOFILE=65536

StandardOutput=journal
StandardError=journal

[Install]
WantedBy=multi-user.target
EOF

# é‡æ–°åŠ è½½ systemd
systemctl daemon-reload

# å¯åŠ¨æœåŠ¡
systemctl start openlist

# è®¾ç½®å¼€æœºè‡ªå¯
systemctl enable openlist

# æŸ¥çœ‹çŠ¶æ€
systemctl status openlist
```

### 5. éªŒè¯åŽç«¯è¿è¡Œ

åœ¨å®å¡” **ç»ˆç«¯** ä¸­æ‰§è¡Œï¼š

```bash
# æ£€æŸ¥è¿›ç¨‹
ps aux | grep openlist

# æ£€æŸ¥ç«¯å£
netstat -tulpn | grep 5244

# æµ‹è¯• API
curl http://localhost:5244/api/public/settings
```

å¦‚æžœè¿”å›ž JSON æ•°æ®ï¼Œè¯´æ˜ŽåŽç«¯å¯åŠ¨æˆåŠŸï¼

---

## ðŸŽ¨ éƒ¨ç½²å‰ç«¯æœåŠ¡

### 1. ä¸Šä¼ å‰ç«¯æ–‡ä»¶

å°†æœ¬åœ° `dist` ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ä¸Šä¼ åˆ° `/opt/openlist/public/dist/`

#### æ–¹æ³•ä¸€ï¼šå®å¡”é¢æ¿ä¸Šä¼ 

1. åœ¨æœ¬åœ°ï¼Œå°† `dist` æ–‡ä»¶å¤¹æ‰“åŒ…æˆ `dist.zip`
2. å®å¡” â†’ **æ–‡ä»¶** â†’ è¿›å…¥ `/opt/openlist/public/`
3. ä¸Šä¼  `dist.zip`
4. å³é”® â†’ **è§£åŽ‹** â†’ è§£åŽ‹åˆ°å½“å‰ç›®å½•
5. ç¡®è®¤ `/opt/openlist/public/dist/index.html` å­˜åœ¨

#### æ–¹æ³•äºŒï¼šSSH ä¸Šä¼ 

```bash
# åœ¨æœ¬åœ° PowerShell ä¸­
scp -r dist/* root@ä½ çš„æœåŠ¡å™¨IP:/opt/openlist/public/dist/
```

### 2. åˆ›å»ºç½‘ç«™

#### åœ¨å®å¡”é¢æ¿ä¸­ï¼š

1. å·¦ä¾§èœå• â†’ **ç½‘ç«™**
2. ç‚¹å‡»"æ·»åŠ ç«™ç‚¹"
3. å¡«å†™ä¿¡æ¯ï¼š
   - **åŸŸå**: `ä½ çš„åŸŸå.com` æˆ– `ä½ çš„æœåŠ¡å™¨IP`
   - **æ ¹ç›®å½•**: `/opt/openlist/public/dist`
   - **PHP ç‰ˆæœ¬**: çº¯é™æ€ï¼ˆä¸éœ€è¦ PHPï¼‰
   - **æ•°æ®åº“**: ä¸åˆ›å»º
   - **FTP**: ä¸åˆ›å»º
4. ç‚¹å‡»"æäº¤"

### 3. é…ç½®åå‘ä»£ç†

åˆ›å»ºç½‘ç«™åŽï¼Œç‚¹å‡»ç½‘ç«™åç§°æ—çš„"è®¾ç½®"æŒ‰é’®ï¼š

#### é…ç½®æ­¥éª¤ï¼š

1. ç‚¹å‡»"åå‘ä»£ç†"æ ‡ç­¾
2. ç‚¹å‡»"æ·»åŠ åå‘ä»£ç†"
3. å¡«å†™é…ç½®ï¼š

**ä»£ç†åç§°**: `openlist-backend`

**ç›®æ ‡ URL**: `http://127.0.0.1:5244`

**å‘é€åŸŸå**: `$host`

**å†…å®¹æ›¿æ¢**: ç•™ç©º

**é«˜çº§è®¾ç½®**ï¼ˆç‚¹å‡»å±•å¼€ï¼‰ï¼š

```nginx
proxy_set_header Host $host;
proxy_set_header X-Real-IP $remote_addr;
proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
proxy_set_header X-Forwarded-Proto $scheme;

# WebSocket æ”¯æŒ
proxy_http_version 1.1;
proxy_set_header Upgrade $http_upgrade;
proxy_set_header Connection "upgrade";

# è¶…æ—¶è®¾ç½®
proxy_connect_timeout 60s;
proxy_send_timeout 60s;
proxy_read_timeout 60s;

# ç¼“å†²è®¾ç½®
proxy_buffering off;
proxy_request_buffering off;
```

4. ç‚¹å‡»"ä¿å­˜"

### 4. æ‰‹åŠ¨ä¼˜åŒ– Nginx é…ç½®ï¼ˆæŽ¨èï¼‰

ç‚¹å‡»ç½‘ç«™çš„"è®¾ç½®" â†’ "é…ç½®æ–‡ä»¶"ï¼Œæ›¿æ¢ä¸ºä»¥ä¸‹å†…å®¹ï¼š

```nginx
server {
    listen 80;
    server_name ä½ çš„åŸŸå.com;  # ä¿®æ”¹ä¸ºå®žé™…åŸŸåæˆ–æœåŠ¡å™¨IP
    
    # æ—¥å¿—
    access_log /www/wwwlogs/openlist_access.log;
    error_log /www/wwwlogs/openlist_error.log;
    
    # å‰ç«¯é™æ€æ–‡ä»¶
    location / {
        root /opt/openlist/public/dist;
        index index.html;
        try_files $uri $uri/ /index.html;
        
        # é™æ€æ–‡ä»¶ç¼“å­˜
        location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ {
            expires 1y;
            add_header Cache-Control "public, immutable";
        }
    }
    
    # åŽç«¯ API ä»£ç†
    location /api/ {
        proxy_pass http://127.0.0.1:5244;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        
        # WebSocket æ”¯æŒ
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        
        # è¶…æ—¶è®¾ç½®
        proxy_connect_timeout 60s;
        proxy_send_timeout 3600s;
        proxy_read_timeout 3600s;
    }
    
    # WebDAV æ”¯æŒ
    location /dav/ {
        proxy_pass http://127.0.0.1:5244;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_request_buffering off;
        client_max_body_size 0;
    }
    
    # æ–‡ä»¶ä¸Šä¼ å¤§å°é™åˆ¶ï¼ˆ10GBï¼‰
    client_max_body_size 10G;
    
    # ç¦æ­¢è®¿é—®éšè—æ–‡ä»¶
    location ~ /\. {
        deny all;
    }
}
```

ç‚¹å‡»"ä¿å­˜"ã€‚

### 5. éªŒè¯éƒ¨ç½²

1. åœ¨æµè§ˆå™¨ä¸­è®¿é—®ï¼š`http://ä½ çš„æœåŠ¡å™¨IP`
2. åº”è¯¥èƒ½çœ‹åˆ° OpenList çš„ç™»å½•ç•Œé¢
3. å¦‚æžœçœ‹ä¸åˆ°ï¼Œæ£€æŸ¥ï¼š
   - Nginx æ˜¯å¦è¿è¡Œï¼šå®å¡” â†’ è½¯ä»¶å•†åº— â†’ Nginx â†’ è¿è¡ŒçŠ¶æ€
   - åŽç«¯æ˜¯å¦è¿è¡Œï¼šç»ˆç«¯æ‰§è¡Œ `systemctl status openlist`
   - æŸ¥çœ‹é”™è¯¯æ—¥å¿—ï¼šå®å¡” â†’ ç½‘ç«™ â†’ æ—¥å¿—

---

## ðŸ”’ é…ç½®åŸŸåå’Œ HTTPS

### 1. ç»‘å®šåŸŸå

#### åœ¨åŸŸåæœåŠ¡å•†ï¼š

1. ç™»å½•åŸŸåç®¡ç†æŽ§åˆ¶å°ï¼ˆé˜¿é‡Œäº‘ã€è…¾è®¯äº‘ç­‰ï¼‰
2. æ‰¾åˆ°ä½ çš„åŸŸå
3. æ·»åŠ è§£æžè®°å½•ï¼š
   - **è®°å½•ç±»åž‹**: `A`
   - **ä¸»æœºè®°å½•**: `@` æˆ– `www`
   - **è®°å½•å€¼**: `ä½ çš„æœåŠ¡å™¨IP`
   - **TTL**: `10åˆ†é’Ÿ`

ç­‰å¾… DNS ç”Ÿæ•ˆï¼ˆé€šå¸¸ 5-10 åˆ†é’Ÿï¼‰ã€‚

#### åœ¨å®å¡”é¢æ¿ï¼š

1. ç½‘ç«™ â†’ ç‚¹å‡»ç½‘ç«™çš„"è®¾ç½®"
2. ç‚¹å‡»"åŸŸåç®¡ç†"
3. æ·»åŠ ä½ çš„åŸŸåï¼š`example.com` å’Œ `www.example.com`
4. ç‚¹å‡»"ä¿å­˜"

### 2. ç”³è¯· SSL è¯ä¹¦ï¼ˆå…è´¹ï¼‰

å®å¡”é¢æ¿é›†æˆäº† Let's Encrypt å…è´¹è¯ä¹¦ï¼š

1. ç½‘ç«™ â†’ ç‚¹å‡»ç½‘ç«™çš„"è®¾ç½®"
2. ç‚¹å‡»"SSL"æ ‡ç­¾
3. é€‰æ‹©"Let's Encrypt"
4. å‹¾é€‰ä½ çš„åŸŸå
5. å‹¾é€‰"è‡ªåŠ¨ç»„åˆä¸ºé€šé…ç¬¦è¯ä¹¦"ï¼ˆå¯é€‰ï¼‰
6. ç‚¹å‡»"ç”³è¯·"
7. ç­‰å¾… 1-2 åˆ†é’Ÿï¼Œè¯ä¹¦ç”³è¯·æˆåŠŸ
8. ç‚¹å‡»å³ä¸Šè§’çš„"å¼ºåˆ¶ HTTPS"å¼€å…³

çŽ°åœ¨å¯ä»¥é€šè¿‡ `https://ä½ çš„åŸŸå.com` è®¿é—®äº†ï¼

### 3. å…¶ä»– SSL è¯ä¹¦é€‰é¡¹

#### ä¸Šä¼ è‡ªå·±çš„è¯ä¹¦

å¦‚æžœä½ æœ‰è´­ä¹°çš„è¯ä¹¦ï¼š

1. SSL æ ‡ç­¾ â†’ é€‰æ‹©"å…¶ä»–è¯ä¹¦"
2. ç²˜è´´è¯ä¹¦å†…å®¹ï¼ˆ.crt æˆ– .pemï¼‰
3. ç²˜è´´ç§é’¥å†…å®¹ï¼ˆ.keyï¼‰
4. ç‚¹å‡»"ä¿å­˜"

#### ä½¿ç”¨å®å¡” SSL è¯ä¹¦

1. SSL æ ‡ç­¾ â†’ é€‰æ‹©"å®å¡”SSL"
2. ç‚¹å‡»"ç”³è¯·"ï¼ˆéœ€è¦å®å¡”è´¦å·ï¼‰

---

## ðŸ”§ æ—¥å¸¸ç»´æŠ¤

### 1. æŸ¥çœ‹æ—¥å¿—

#### åº”ç”¨æ—¥å¿—

å®å¡”é¢æ¿ â†’ **æ–‡ä»¶** â†’ è¿›å…¥ `/opt/openlist/data/log/log.log`

#### Nginx æ—¥å¿—

å®å¡”é¢æ¿ â†’ **ç½‘ç«™** â†’ ç‚¹å‡»ç½‘ç«™çš„"æ—¥å¿—"æŒ‰é’®

#### ç³»ç»Ÿæ—¥å¿—

å®å¡”é¢æ¿ â†’ **ç»ˆç«¯**ï¼š

```bash
# æŸ¥çœ‹ OpenList æœåŠ¡æ—¥å¿—
journalctl -u openlist -f

# æŸ¥çœ‹æœ€è¿‘ 100 è¡Œ
journalctl -u openlist -n 100
```

### 2. é‡å¯æœåŠ¡

#### é‡å¯ OpenList åŽç«¯

**æ–¹æ³•ä¸€ï¼šä½¿ç”¨ Supervisor**ï¼ˆå¦‚æžœå®‰è£…äº†ï¼‰
1. è½¯ä»¶å•†åº— â†’ Supervisor â†’ è®¾ç½®
2. æ‰¾åˆ° openlist è¿›ç¨‹
3. ç‚¹å‡»"é‡å¯"

**æ–¹æ³•äºŒï¼šä½¿ç”¨ç»ˆç«¯**
```bash
systemctl restart openlist
```

#### é‡å¯ Nginx

å®å¡”é¢æ¿ â†’ **è½¯ä»¶å•†åº—** â†’ Nginx â†’ ç‚¹å‡»"é‡å¯"

### 3. æ›´æ–°éƒ¨ç½²

#### æ›´æ–°åŽç«¯

```bash
# åœæ­¢æœåŠ¡
systemctl stop openlist

# å¤‡ä»½æ—§ç‰ˆæœ¬
cp /opt/openlist/openlist /opt/openlist/openlist.backup

# ä¸Šä¼ æ–°çš„ openlist æ–‡ä»¶ï¼ˆé€šè¿‡å®å¡”æ–‡ä»¶ç®¡ç†æˆ– scpï¼‰
# ç„¶åŽåœ¨ç»ˆç«¯æ‰§è¡Œï¼š
chmod +x /opt/openlist/openlist

# å¯åŠ¨æœåŠ¡
systemctl start openlist
```

#### æ›´æ–°å‰ç«¯

1. åˆ é™¤æ—§çš„å‰ç«¯æ–‡ä»¶ï¼š`/opt/openlist/public/dist/*`
2. ä¸Šä¼ æ–°çš„ `dist` æ–‡ä»¶å¤¹å†…å®¹
3. æ— éœ€é‡å¯ï¼ŒNginx ä¼šè‡ªåŠ¨ä½¿ç”¨æ–°æ–‡ä»¶

### 4. æ•°æ®å¤‡ä»½

#### è‡ªåŠ¨å¤‡ä»½ï¼ˆæŽ¨èï¼‰

1. å®å¡”é¢æ¿ â†’ **è®¡åˆ’ä»»åŠ¡**
2. ç‚¹å‡»"æ·»åŠ è®¡åˆ’ä»»åŠ¡"
3. å¡«å†™ï¼š
   - **ä»»åŠ¡ç±»åž‹**: Shell è„šæœ¬
   - **ä»»åŠ¡åç§°**: `OpenList æ•°æ®å¤‡ä»½`
   - **æ‰§è¡Œå‘¨æœŸ**: æ¯å¤© 03:00
   - **è„šæœ¬å†…å®¹**:

```bash
#!/bin/bash
BACKUP_DIR="/www/backup/openlist"
DATE=$(date +%Y%m%d_%H%M%S)

mkdir -p $BACKUP_DIR

# å¤‡ä»½æ•°æ®åº“å’Œé…ç½®
tar -czf $BACKUP_DIR/openlist-data-$DATE.tar.gz \
    /opt/openlist/data/data.db \
    /opt/openlist/data/config.json

# åªä¿ç•™æœ€è¿‘ 7 å¤©çš„å¤‡ä»½
find $BACKUP_DIR -name "openlist-data-*.tar.gz" -mtime +7 -delete

echo "å¤‡ä»½å®Œæˆ: $BACKUP_DIR/openlist-data-$DATE.tar.gz"
```

4. ç‚¹å‡»"ä¿å­˜"

#### æ‰‹åŠ¨å¤‡ä»½

åœ¨å®å¡”æ–‡ä»¶ç®¡ç†ä¸­ï¼š
1. è¿›å…¥ `/opt/openlist/data/`
2. é€‰ä¸­ `data.db` å’Œ `config.json`
3. ç‚¹å‡»"åŽ‹ç¼©"
4. ä¸‹è½½åŽ‹ç¼©åŒ…

### 5. ç›‘æŽ§æœåŠ¡çŠ¶æ€

#### å®‰è£…æœåŠ¡å™¨ç›‘æŽ§æ’ä»¶

1. å®å¡”é¢æ¿ â†’ **è½¯ä»¶å•†åº—**
2. æœç´¢"ç³»ç»Ÿç›‘æŽ§"æˆ–"Nginxç›‘æŽ§"
3. å®‰è£…åŽå¯ä»¥çœ‹åˆ°ï¼š
   - CPU ä½¿ç”¨çŽ‡
   - å†…å­˜ä½¿ç”¨çŽ‡
   - ç£ç›˜ IO
   - ç½‘ç»œæµé‡
   - è¿›ç¨‹çŠ¶æ€

#### è®¾ç½®è¿›ç¨‹ç›‘æŽ§

1. è½¯ä»¶å•†åº— â†’ å®‰è£…"è¿›ç¨‹å®ˆæŠ¤ç®¡ç†å™¨"ï¼ˆSupervisorï¼‰
2. æ·»åŠ  openlist è¿›ç¨‹ç›‘æŽ§
3. è¿›ç¨‹å¼‚å¸¸ä¼šè‡ªåŠ¨é‡å¯

---

## ðŸ“Š æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 1. å¯ç”¨ Nginx ç¼“å­˜

åœ¨ç½‘ç«™é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ï¼š

```nginx
# åœ¨ http å—ä¸­æ·»åŠ 
proxy_cache_path /tmp/nginx_cache levels=1:2 keys_zone=cache_one:100m inactive=1d max_size=1g;

# åœ¨ location /api/ ä¸­æ·»åŠ 
proxy_cache cache_one;
proxy_cache_key $host$uri$is_args$args;
proxy_cache_valid 200 10m;
```

### 2. å¯ç”¨ Gzip åŽ‹ç¼©

å®å¡”é¢æ¿ â†’ è½¯ä»¶å•†åº— â†’ Nginx â†’ è®¾ç½® â†’ æ€§èƒ½è°ƒæ•´ï¼š
- å¼€å¯ Gzip åŽ‹ç¼©
- è®¾ç½® Gzip ç­‰çº§ï¼š6

### 3. ä¼˜åŒ– SQLite æ€§èƒ½

åœ¨ç»ˆç«¯æ‰§è¡Œï¼š

```bash
# å®šæœŸæ‰§è¡Œ VACUUM æ¸…ç†æ•°æ®åº“
sqlite3 /opt/openlist/data/data.db "VACUUM;"

# æ·»åŠ åˆ°è®¡åˆ’ä»»åŠ¡ï¼ˆæ¯å‘¨æ‰§è¡Œä¸€æ¬¡ï¼‰
```

### 4. è°ƒæ•´æ–‡ä»¶ä¸Šä¼ é™åˆ¶

å¦‚æžœéœ€è¦ä¸Šä¼ å¤§æ–‡ä»¶ï¼Œåœ¨ç½‘ç«™é…ç½®ä¸­è°ƒæ•´ï¼š

```nginx
client_max_body_size 50G;  # æ ¹æ®éœ€æ±‚è°ƒæ•´
```

---

## â“ å¸¸è§é—®é¢˜

### Q1: æ— æ³•è®¿é—®ç½‘ç«™ï¼Ÿ

**æ£€æŸ¥æ¸…å•**ï¼š
1. âœ… æœåŠ¡å™¨é˜²ç«å¢™æ˜¯å¦å¼€æ”¾ 80/443 ç«¯å£
2. âœ… äº‘æœåŠ¡å•†å®‰å…¨ç»„æ˜¯å¦å¼€æ”¾ 80/443 ç«¯å£
3. âœ… Nginx æ˜¯å¦æ­£å¸¸è¿è¡Œ
4. âœ… OpenList åŽç«¯æ˜¯å¦æ­£å¸¸è¿è¡Œ
5. âœ… åŸŸåæ˜¯å¦æ­£ç¡®è§£æžåˆ°æœåŠ¡å™¨ IP

**æŽ’æŸ¥å‘½ä»¤**ï¼š
```bash
# æ£€æŸ¥ç«¯å£
netstat -tulpn | grep :80
netstat -tulpn | grep :5244

# æ£€æŸ¥è¿›ç¨‹
ps aux | grep openlist
ps aux | grep nginx

# æµ‹è¯•æœ¬åœ°è®¿é—®
curl http://localhost
curl http://localhost:5244/api/public/settings
```

### Q2: API è¯·æ±‚ 502 é”™è¯¯ï¼Ÿ

åŽç«¯æœåŠ¡æœªå¯åŠ¨æˆ–å´©æºƒï¼š

```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
systemctl status openlist

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
journalctl -u openlist -n 100

# é‡å¯æœåŠ¡
systemctl restart openlist
```

### Q3: ä¸Šä¼ æ–‡ä»¶å¤±è´¥ï¼Ÿ

æ£€æŸ¥ Nginx é…ç½®ä¸­çš„ `client_max_body_size` è®¾ç½®ã€‚

### Q4: å®å¡”é¢æ¿è¢«é”å®šæˆ–å¿˜è®°å¯†ç ï¼Ÿ

```bash
# SSH è¿žæŽ¥åˆ°æœåŠ¡å™¨
# é‡ç½®é¢æ¿å¯†ç 
bt default

# æŸ¥çœ‹é¢æ¿ä¿¡æ¯
bt info
```

### Q5: SSL è¯ä¹¦ç”³è¯·å¤±è´¥ï¼Ÿ

ç¡®ä¿ï¼š
1. åŸŸåå·²æ­£ç¡®è§£æžåˆ°æœåŠ¡å™¨ IP
2. æœåŠ¡å™¨é˜²ç«å¢™å’Œå®‰å…¨ç»„å·²å¼€æ”¾ 80 ç«¯å£
3. åŸŸåæ²¡æœ‰è¢«å¢™æˆ–å¤‡æ¡ˆé—®é¢˜ï¼ˆä¸­å›½å¤§é™†ï¼‰

---

## ðŸŽ‰ éƒ¨ç½²å®Œæˆ

æ­å–œï¼ä½ å·²ç»æˆåŠŸä½¿ç”¨å®å¡”é¢æ¿éƒ¨ç½²äº† OpenListï¼

**è®¿é—®åœ°å€**ï¼š
- HTTP: `http://ä½ çš„åŸŸå.com` æˆ– `http://ä½ çš„IP`
- HTTPS: `https://ä½ çš„åŸŸå.com`

**é»˜è®¤è´¦å·**ï¼šé¦–æ¬¡è®¿é—®æ—¶ä¼šæç¤ºåˆ›å»ºç®¡ç†å‘˜è´¦å·

**ä¸‹ä¸€æ­¥**ï¼š
1. åˆ›å»ºç®¡ç†å‘˜è´¦å·
2. é…ç½®å­˜å‚¨é©±åŠ¨
3. ä¸Šä¼ æ–‡ä»¶æµ‹è¯•
4. è®¾ç½®å®šæœŸå¤‡ä»½

---

## ðŸ“š å‚è€ƒèµ„æº

- OpenList å®˜æ–¹æ–‡æ¡£: https://github.com/OpenListTeam/OpenList
- å®å¡”é¢æ¿å®˜ç½‘: https://www.bt.cn
- Nginx æ–‡æ¡£: https://nginx.org/en/docs/

---

**ç¥ä½ ä½¿ç”¨æ„‰å¿«ï¼** ðŸš€

