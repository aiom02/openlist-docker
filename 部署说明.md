# OpenList Docker éƒ¨ç½²è¯´æ˜

## ğŸ“‹ æœ¬åœ°æ„å»ºæ­¥éª¤

### 1. æ„å»ºå‰ç«¯
```bash
# åŒå‡»è¿è¡Œ
1-æ„å»ºå‰ç«¯.bat
```
è¿™å°†ä¼šï¼š
- æ£€æŸ¥ pnpm æ˜¯å¦å®‰è£…
- å®‰è£…å‰ç«¯ä¾èµ–
- æ„å»ºå‰ç«¯é¡¹ç›®åˆ° `dist` ç›®å½•

### 2. æ„å»º Docker é•œåƒ
```bash
# åŒå‡»è¿è¡Œ
2-æ„å»ºDockeré•œåƒ.bat
```
è¿™å°†ä¼šï¼š
- æ„å»ºåç«¯é•œåƒ `openlist-backend:latest`
- æ„å»ºå‰ç«¯é•œåƒ `openlist-frontend:latest`

### 3. å¯¼å‡º Docker é•œåƒ
```bash
# åŒå‡»è¿è¡Œ
3-å¯¼å‡ºDockeré•œåƒ.bat
```
è¿™å°†ä¼šåœ¨ `docker-images-export` ç›®å½•ä¸‹ç”Ÿæˆï¼š
- `openlist-backend.tar` (åç«¯é•œåƒ)
- `openlist-frontend.tar` (å‰ç«¯é•œåƒ)
- `docker-compose.yml` (é…ç½®æ–‡ä»¶)

---

## ğŸš€ æœåŠ¡å™¨éƒ¨ç½²æ­¥éª¤

### 1. ä¸Šä¼ æ–‡ä»¶åˆ°æœåŠ¡å™¨
å°† `docker-images-export` ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œä¾‹å¦‚ï¼š
```bash
# ä½¿ç”¨ scp ä¸Šä¼  (åœ¨æœ¬åœ° PowerShell ä¸­è¿è¡Œ)
scp -r docker-images-export/* user@your-server:/opt/openlist/

# æˆ–ä½¿ç”¨ SFTP/FTP å·¥å…·ä¸Šä¼ 
```

### 2. SSH è¿æ¥åˆ°æœåŠ¡å™¨


### 3. åŠ è½½ Docker é•œåƒ
```bash
# è¿›å…¥ä¸Šä¼ ç›®å½•
cd /opt/openlist-docker

# åŠ è½½åç«¯é•œåƒ
docker load -i openlist-backend.tar

# åŠ è½½å‰ç«¯é•œåƒ
docker load -i openlist-frontend.tar

# éªŒè¯é•œåƒåŠ è½½æˆåŠŸ
docker images | grep openlist
```

### 4. åˆ›å»ºæ•°æ®ç›®å½•
```bash
# åˆ›å»ºæ•°æ®æŒä¹…åŒ–ç›®å½•
mkdir -p /opt/openlist/data

# è®¾ç½®æƒé™ (UID=1001 æ˜¯å®¹å™¨ä¸­çš„ç”¨æˆ·)
chown -R 1001:1001 /opt/openlist/data
chmod 755 /opt/openlist/data
```

### 5. å¯åŠ¨æœåŠ¡
```bash
# ä½¿ç”¨ docker-compose å¯åŠ¨
docker-compose up -d

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f
```

### 6. éªŒè¯éƒ¨ç½²
```bash
# æ£€æŸ¥å®¹å™¨è¿è¡ŒçŠ¶æ€
docker ps

# æ£€æŸ¥åç«¯å¥åº·çŠ¶æ€
curl http://localhost:5244/ping

# æ£€æŸ¥å‰ç«¯
curl http://localhost:80
```

---

## ğŸ”§ å¸¸ç”¨ç®¡ç†å‘½ä»¤

### æŸ¥çœ‹æ—¥å¿—
```bash
# æŸ¥çœ‹æ‰€æœ‰æœåŠ¡æ—¥å¿—
docker-compose logs -f

# åªæŸ¥çœ‹åç«¯æ—¥å¿—
docker-compose logs -f openlist-backend

# åªæŸ¥çœ‹å‰ç«¯æ—¥å¿—
docker-compose logs -f openlist-frontend
```

### é‡å¯æœåŠ¡
```bash
# é‡å¯æ‰€æœ‰æœåŠ¡
docker-compose restart

# åªé‡å¯åç«¯
docker-compose restart openlist-backend

# åªé‡å¯å‰ç«¯
docker-compose restart openlist-frontend
```

### åœæ­¢æœåŠ¡
```bash
# åœæ­¢æœåŠ¡ä½†ä¿ç•™å®¹å™¨
docker-compose stop

# åœæ­¢å¹¶åˆ é™¤å®¹å™¨
docker-compose down

# åœæ­¢å¹¶åˆ é™¤å®¹å™¨ã€ç½‘ç»œã€å·
docker-compose down -v
```

### æ›´æ–°æœåŠ¡
```bash
# 1. ä¸Šä¼ æ–°çš„é•œåƒæ–‡ä»¶
# 2. åœæ­¢æ—§æœåŠ¡
docker-compose down

# 3. åˆ é™¤æ—§é•œåƒ
docker rmi openlist-backend:latest openlist-frontend:latest

# 4. åŠ è½½æ–°é•œåƒ
docker load -i openlist-backend.tar
docker load -i openlist-frontend.tar

# 5. å¯åŠ¨æ–°æœåŠ¡
docker-compose up -d
```

---

## ğŸ“ ç«¯å£è¯´æ˜

- **å‰ç«¯**: `80` (HTTP)
- **åç«¯**: `5244` (HTTP API)
- **åç«¯**: `5245` (WebDAV)

æ ¹æ®å®é™…éœ€æ±‚ä¿®æ”¹ `docker-compose.yml` ä¸­çš„ç«¯å£æ˜ å°„ã€‚

---

## ğŸ” å®‰å…¨å»ºè®®

1. **ä½¿ç”¨åå‘ä»£ç† (æ¨èä½¿ç”¨ Nginx/Caddy)**
   ```nginx
   # Nginx é…ç½®ç¤ºä¾‹
   server {
       listen 443 ssl http2;
       server_name your-domain.com;
       
       ssl_certificate /path/to/cert.pem;
       ssl_certificate_key /path/to/key.pem;
       
       location / {
           proxy_pass http://localhost:80;
           proxy_set_header Host $host;
           proxy_set_header X-Real-IP $remote_addr;
           proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
           proxy_set_header X-Forwarded-Proto $scheme;
       }
   }
   ```

2. **é…ç½®é˜²ç«å¢™**
   ```bash
   # åªå¼€æ”¾å¿…è¦ç«¯å£
   ufw allow 80/tcp
   ufw allow 443/tcp
   ufw enable
   ```

3. **å®šæœŸå¤‡ä»½æ•°æ®**
   ```bash
   # å¤‡ä»½æ•°æ®ç›®å½•
   tar -czf openlist-backup-$(date +%Y%m%d).tar.gz /opt/openlist/data
   ```

---

## ğŸ› æ•…éšœæ’æŸ¥

### å®¹å™¨æ— æ³•å¯åŠ¨
```bash
# æŸ¥çœ‹è¯¦ç»†é”™è¯¯æ—¥å¿—
docker-compose logs

# æ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨
netstat -tulpn | grep -E '80|5244|5245'
```

### æ•°æ®æƒé™é—®é¢˜
```bash
# é‡æ–°è®¾ç½®æƒé™
chown -R 1001:1001 /opt/openlist/data
chmod -R 755 /opt/openlist/data
```

### å‰ç«¯æ— æ³•è¿æ¥åç«¯
æ£€æŸ¥ `docker-compose.yml` ä¸­çš„ç½‘ç»œé…ç½®ï¼Œç¡®ä¿ä¸¤ä¸ªå®¹å™¨åœ¨åŒä¸€ç½‘ç»œä¸­ã€‚

---

## ğŸ“ è·å–å¸®åŠ©

- æŸ¥çœ‹æ—¥å¿—: `docker-compose logs -f`
- è¿›å…¥å®¹å™¨è°ƒè¯•: `docker exec -it openlist-backend sh`
- GitHub Issues: https://github.com/OpenListTeam/OpenList/issues

