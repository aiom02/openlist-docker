# ðŸŽ¯ ä½ éœ€è¦çš„æ­£ç¡®éƒ¨ç½²æ–¹æ¡ˆ

## ä¸ºä»€ä¹ˆä¸èƒ½ç”¨å®˜æ–¹ Docker é•œåƒï¼Ÿ

**å› ä¸ºä½ æ·»åŠ äº†è‡ªå®šä¹‰åŽç«¯åŠŸèƒ½ï¼**

ä½ çš„é¡¹ç›®åŒ…å«ï¼š
- âœ… è‡ªå®šä¹‰å‰ç«¯ï¼ˆSolid.js/TypeScriptï¼‰
- âœ… **è‡ªå®šä¹‰åŽç«¯ï¼ˆGoï¼‰** âš ï¸ è¿™æ˜¯å…³é”®ï¼

ä½ æ·»åŠ çš„åŽç«¯åŠŸèƒ½ï¼š
```
OpenList-main/
â”œâ”€â”€ server/handles/
â”‚   â”œâ”€â”€ video_favorites.go    â† ä½ æ·»åŠ çš„è§†é¢‘æ”¶è—API
â”‚   â””â”€â”€ audio_favorites.go    â† ä½ æ·»åŠ çš„éŸ³é¢‘æ”¶è—API
â”œâ”€â”€ internal/
â”‚   â”œâ”€â”€ model/
â”‚   â”‚   â”œâ”€â”€ video_favorite.go â† è§†é¢‘æ”¶è—æ•°æ®æ¨¡åž‹
â”‚   â”‚   â””â”€â”€ audio_favorite.go â† éŸ³é¢‘æ”¶è—æ•°æ®æ¨¡åž‹
â”‚   â”œâ”€â”€ db/
â”‚   â”‚   â”œâ”€â”€ video_favorites.goâ† æ•°æ®åº“æ“ä½œ
â”‚   â”‚   â””â”€â”€ audio_favorites.goâ† æ•°æ®åº“æ“ä½œ
â”‚   â””â”€â”€ op/
â”‚       â””â”€â”€ media_marks.go    â† åª’ä½“æ ‡è®°åŠŸèƒ½
```

**å®˜æ–¹ Docker é•œåƒæ²¡æœ‰è¿™äº›åŠŸèƒ½ï¼**

---

## ðŸ“‹ ä½ çš„æ­£ç¡®éƒ¨ç½²æ­¥éª¤

### æ–¹å¼ä¸€ï¼šå®Œæ•´ç¼–è¯‘éƒ¨ç½²ï¼ˆæŽ¨èï¼‰â­

è¿™æ˜¯æœ€é€‚åˆä½ çš„æ–¹å¼ï¼Œå› ä¸ºä½ ä¿®æ”¹äº†åŽç«¯ä»£ç ã€‚

#### Windows ç”¨æˆ·

**ä¸€é”®éƒ¨ç½²ï¼š**
```
åŒå‡»è¿è¡Œ: æ‚é¡¹\å®Œæ•´ç¼–è¯‘éƒ¨ç½².bat
```

è„šæœ¬ä¼šè‡ªåŠ¨ï¼š
1. âœ… åœ¨æœ¬åœ°ç¼–è¯‘å‰ç«¯
2. âœ… æ‰“åŒ…å‰åŽç«¯ä»£ç 
3. âœ… ä¸Šä¼ åˆ°æœåŠ¡å™¨
4. âœ… åœ¨æœåŠ¡å™¨ä¸Šç¼–è¯‘åŽç«¯
5. âœ… åˆ›å»ºç³»ç»ŸæœåŠ¡å¹¶å¯åŠ¨

#### Linux/Mac ç”¨æˆ·

```bash
bash æ‚é¡¹/å®Œæ•´ç¼–è¯‘éƒ¨ç½².sh
```

---

### æ–¹å¼äºŒï¼šæ‰‹åŠ¨éƒ¨ç½²ï¼ˆå¦‚æžœè„šæœ¬ä¸å·¥ä½œï¼‰

#### æ­¥éª¤ 1: æœ¬åœ°ç¼–è¯‘å‰ç«¯

```bash
cd OpenList-Frontend-main

# å®‰è£…ä¾èµ–
pnpm install
# æˆ– npm install

# æž„å»º
pnpm build
# æˆ– npm run build

cd ..
```

#### æ­¥éª¤ 2: åˆå¹¶å‰åŽç«¯

```bash
# Windows
rmdir /s /q OpenList-main\public\dist
xcopy /e /i /y OpenList-Frontend-main\dist\* OpenList-main\public\dist\

# Linux/Mac
rm -rf OpenList-main/public/dist/*
cp -r OpenList-Frontend-main/dist/* OpenList-main/public/dist/
```

#### æ­¥éª¤ 3: æ‰“åŒ…é¡¹ç›®

```bash
# Windows
cd OpenList-main
tar -czf ..\openlist-backend.tar.gz --exclude=".git" --exclude="data" --exclude="*.exe" --exclude="bin" .
cd ..

# Linux/Mac
cd OpenList-main
tar -czf ../openlist-backend.tar.gz --exclude='.git' --exclude='data' --exclude='bin' .
cd ..
```

#### æ­¥éª¤ 4: ä¸Šä¼ åˆ°æœåŠ¡å™¨

```bash
scp openlist-backend.tar.gz root@70.39.205.183:/tmp/
```

#### æ­¥éª¤ 5: SSH è¿žæŽ¥æœåŠ¡å™¨å¹¶éƒ¨ç½²

```bash
ssh root@70.39.205.183
```

ç„¶åŽåœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼š

```bash
# 1. å®‰è£… Goï¼ˆå¦‚æžœæ²¡æœ‰ï¼‰
wget https://go.dev/dl/go1.21.0.linux-amd64.tar.gz
tar -C /usr/local -xzf go1.21.0.linux-amd64.tar.gz
echo 'export PATH=$PATH:/usr/local/go/bin' >> ~/.bashrc
source ~/.bashrc

# 2. åˆ›å»ºé¡¹ç›®ç›®å½•
mkdir -p /opt/openlist-custom
cd /opt/openlist-custom

# 3. è§£åŽ‹ä»£ç 
tar -xzf /tmp/openlist-backend.tar.gz

# 4. ç¼–è¯‘åŽç«¯
bash build.sh release

# 5. åˆ›å»ºç³»ç»ŸæœåŠ¡
cat > /etc/systemd/system/openlist-custom.service << 'EOF'
[Unit]
Description=OpenList Custom Service
After=network.target

[Service]
Type=simple
User=root
WorkingDirectory=/opt/openlist-custom
ExecStart=/opt/openlist-custom/bin/openlist server
Restart=on-failure
RestartSec=10s

[Install]
WantedBy=multi-user.target
EOF

# 6. å¯åŠ¨æœåŠ¡
systemctl daemon-reload
systemctl enable openlist-custom
systemctl start openlist-custom

# 7. æŸ¥çœ‹çŠ¶æ€
systemctl status openlist-custom
```

---

## âœ… éªŒè¯éƒ¨ç½²

### 1. æ£€æŸ¥æœåŠ¡çŠ¶æ€

```bash
ssh root@70.39.205.183 "systemctl status openlist-custom"
```

### 2. æŸ¥çœ‹æ—¥å¿—

```bash
ssh root@70.39.205.183 "journalctl -u openlist-custom -f"
```

### 3. æµ‹è¯•è®¿é—®

æµè§ˆå™¨æ‰“å¼€: **http://70.39.205.183:5244**

### 4. æµ‹è¯•ä½ çš„è‡ªå®šä¹‰åŠŸèƒ½

- [ ] èƒ½å¦ç™»å½•
- [ ] è§†é¢‘æ’­æ”¾æ˜¯å¦æ­£å¸¸
- [ ] è§†é¢‘æ”¶è—åŠŸèƒ½æ˜¯å¦å¯ç”¨
- [ ] éŸ³é¢‘æ”¶è—åŠŸèƒ½æ˜¯å¦å¯ç”¨
- [ ] æ ‡è®°åŠŸèƒ½æ˜¯å¦å¯ç”¨
- [ ] "æˆ‘çš„æ ‡è®°"é¡µé¢æ˜¯å¦æ­£å¸¸

---

## ðŸ”„ åŽç»­æ›´æ–°æµç¨‹

å½“ä½ ä¿®æ”¹ä»£ç åŽï¼š

### ä»…ä¿®æ”¹å‰ç«¯

```bash
# Windows
åŒå‡»: æ‚é¡¹\æ›´æ–°å‰ç«¯åˆ°æœåŠ¡å™¨.bat
```

### ä¿®æ”¹äº†åŽç«¯

```bash
# Windows
åŒå‡»: æ‚é¡¹\å®Œæ•´ç¼–è¯‘éƒ¨ç½².bat
```

---

## ðŸ“Š ä¸‰ç§æ–¹æ¡ˆå¯¹æ¯”

| æ–¹æ¡ˆ | å‰ç«¯ | åŽç«¯ | é€‚ç”¨æƒ…å†µ |
|------|------|------|----------|
| æ–¹æ¡ˆ 1ï¼šå®˜æ–¹ Docker | å®˜æ–¹ | å®˜æ–¹ | âŒ æ²¡æœ‰ä½ çš„åŠŸèƒ½ |
| æ–¹æ¡ˆ 2ï¼šDocker + è‡ªå®šä¹‰å‰ç«¯ | è‡ªå®šä¹‰ | å®˜æ–¹ | âŒ ç¼ºå°‘åŽç«¯åŠŸèƒ½ |
| **æ–¹æ¡ˆ 3ï¼šå®Œæ•´ç¼–è¯‘éƒ¨ç½²** | **è‡ªå®šä¹‰** | **è‡ªå®šä¹‰** | **âœ… å®Œæ•´åŠŸèƒ½** |

---

## ðŸŽ¯ æ€»ç»“

ä½ å¿…é¡»ä½¿ç”¨**æ–¹æ¡ˆ 3ï¼ˆå®Œæ•´ç¼–è¯‘éƒ¨ç½²ï¼‰**ï¼Œå› ä¸ºï¼š

1. âœ… ä½ çš„å‰ç«¯éœ€è¦è°ƒç”¨è‡ªå®šä¹‰çš„åŽç«¯ API
2. âœ… ä½ çš„åŽç«¯æ·»åŠ äº†è§†é¢‘æ”¶è—ã€éŸ³é¢‘æ”¶è—ã€æ ‡è®°ç­‰åŠŸèƒ½
3. âœ… å®˜æ–¹ Docker é•œåƒä¸åŒ…å«è¿™äº›åŠŸèƒ½
4. âœ… å¿…é¡»ç¼–è¯‘ä½ è‡ªå·±çš„åŽç«¯ä»£ç 

**æœ€ç®€å•çš„æ–¹å¼ï¼š**
```
Windows: åŒå‡» æ‚é¡¹\å®Œæ•´ç¼–è¯‘éƒ¨ç½².bat
Linux:   bash æ‚é¡¹/å®Œæ•´ç¼–è¯‘éƒ¨ç½².sh
```

å°±è¿™ä¹ˆç®€å•ï¼ðŸŽ‰

---

## â“ å¸¸è§é—®é¢˜

### Q: ä¸ºä»€ä¹ˆç¼–è¯‘æ—¶é—´è¿™ä¹ˆé•¿ï¼Ÿ
A: Go åŽç«¯éœ€è¦ä¸‹è½½ä¾èµ–å¹¶ç¼–è¯‘ï¼Œç¬¬ä¸€æ¬¡å¤§çº¦éœ€è¦ 5-10 åˆ†é’Ÿã€‚åŽç»­æ›´æ–°ä¼šå¿«å¾ˆå¤šã€‚

### Q: å¯ä»¥ç”¨ Docker å—ï¼Ÿ
A: å¯ä»¥ï¼Œä½†éœ€è¦è‡ªå·±æž„å»º Docker é•œåƒã€‚å¦‚æžœæƒ³ç”¨ Dockerï¼Œéœ€è¦ï¼š
1. åœ¨æœ¬åœ°æˆ–æœåŠ¡å™¨ä¸Šæž„å»ºåŒ…å«ä½ ä»£ç çš„ Docker é•œåƒ
2. ç„¶åŽè¿è¡Œè¿™ä¸ªé•œåƒ

### Q: å¦‚ä½•å¤‡ä»½æ•°æ®ï¼Ÿ
A: æ•°æ®åœ¨ `/opt/openlist-custom/data` ç›®å½•ï¼š
```bash
ssh root@70.39.205.183
cd /opt/openlist-custom
tar -czf backup-$(date +%Y%m%d).tar.gz data
```

### Q: å¦‚ä½•å›žæ»šåˆ°ä¹‹å‰çš„ç‰ˆæœ¬ï¼Ÿ
A: ä¿ç•™æ¯æ¬¡éƒ¨ç½²çš„ tar.gz åŒ…ï¼Œéœ€è¦æ—¶é‡æ–°éƒ¨ç½²ã€‚

---

çŽ°åœ¨ä½ æ˜Žç™½äº†å—ï¼Ÿå¼€å§‹éƒ¨ç½²å§ï¼ðŸš€

