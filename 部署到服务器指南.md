# OpenList é¡¹ç›®éƒ¨ç½²åˆ°æœåŠ¡å™¨æŒ‡å—

ç›®æ ‡æœåŠ¡å™¨: **70.39.205.183**

## æ–¹æ¡ˆä¸€ï¼šDocker éƒ¨ç½²ï¼ˆæŽ¨èï¼‰â­

è¿™æ˜¯æœ€ç®€å•ã€æœ€å¿«é€Ÿçš„éƒ¨ç½²æ–¹å¼ã€‚

### 1. å‡†å¤‡å·¥ä½œ

é¦–å…ˆï¼ŒSSH è¿žæŽ¥åˆ°æœåŠ¡å™¨ï¼š

```bash
ssh root@70.39.205.183
# æˆ–è€…å¦‚æžœæœ‰ç‰¹å®šç”¨æˆ·
ssh ç”¨æˆ·å@70.39.205.183
```

### 2. å®‰è£… Docker å’Œ Docker Compose

å¦‚æžœæœåŠ¡å™¨è¿˜æ²¡æœ‰å®‰è£… Dockerï¼š

```bash
# å®‰è£… Docker
curl -fsSL https://get.docker.com | sh

# å¯åŠ¨ Docker
systemctl start docker
systemctl enable docker

# å®‰è£… Docker Composeï¼ˆå¦‚æžœéœ€è¦ï¼‰
curl -L "https://github.com/docker/compose/releases/latest/download/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
chmod +x /usr/local/bin/docker-compose
```

### 3. åˆ›å»ºéƒ¨ç½²ç›®å½•

```bash
mkdir -p /opt/openlist
cd /opt/openlist
```

### 4. åˆ›å»º docker-compose.yml

```bash
cat > docker-compose.yml << 'EOF'
services:
  openlist:
    restart: always
    volumes:
      - './data:/opt/openlist/data'
    ports:
      - '5244:5244'
      - '5245:5245'
    user: '0:0'
    environment:
      - UMASK=022
      - TZ=Asia/Shanghai
    container_name: openlist
    image: 'openlistteam/openlist:latest'
EOF
```

### 5. å¯åŠ¨æœåŠ¡

```bash
docker-compose up -d
```

### 6. æ£€æŸ¥æœåŠ¡çŠ¶æ€

```bash
# æŸ¥çœ‹å®¹å™¨çŠ¶æ€
docker ps

# æŸ¥çœ‹æ—¥å¿—
docker logs -f openlist
```

### 7. è®¿é—®åº”ç”¨

åœ¨æµè§ˆå™¨ä¸­è®¿é—®ï¼š
- **http://70.39.205.183:5244**

é»˜è®¤è´¦å·ï¼š
- ç”¨æˆ·å: `admin`
- å¯†ç : `admin`

**âš ï¸ é¦–æ¬¡ç™»å½•åŽè¯·ç«‹å³ä¿®æ”¹å¯†ç ï¼**

### 8. é˜²ç«å¢™é…ç½®ï¼ˆå¦‚æžœéœ€è¦ï¼‰

```bash
# å¼€æ”¾ç«¯å£ï¼ˆæ ¹æ®é˜²ç«å¢™ç±»åž‹é€‰æ‹©ï¼‰

# iptables
iptables -A INPUT -p tcp --dport 5244 -j ACCEPT
iptables-save > /etc/iptables/rules.v4

# firewalld
firewall-cmd --permanent --add-port=5244/tcp
firewall-cmd --permanent --add-port=5245/tcp
firewall-cmd --reload

# ufw
ufw allow 5244/tcp
ufw allow 5245/tcp
```

---

## æ–¹æ¡ˆäºŒï¼šä½¿ç”¨è‡ªå®šä¹‰å‰ç«¯ + Docker åŽç«¯

å¦‚æžœä½ æƒ³ä½¿ç”¨ä¿®æ”¹åŽçš„å‰ç«¯ä»£ç ï¼š

### 1. åœ¨æœ¬åœ°ç¼–è¯‘å‰ç«¯

åœ¨ä½ çš„æœ¬åœ° Windows æœºå™¨ä¸Šï¼š

```bash
cd OpenList-Frontend-main

# å®‰è£…ä¾èµ–
pnpm install
# æˆ–
npm install

# æž„å»ºç”Ÿäº§ç‰ˆæœ¬
pnpm build
# æˆ–
npm run build
```

ç¼–è¯‘å®ŒæˆåŽï¼Œå‰ç«¯æ–‡ä»¶ä¼šåœ¨ `dist` ç›®å½•ä¸­ã€‚

### 2. ä¸Šä¼ å‰ç«¯æ–‡ä»¶åˆ°æœåŠ¡å™¨

```bash
# ä½¿ç”¨ scp ä¸Šä¼ ï¼ˆåœ¨æœ¬åœ°æ‰§è¡Œï¼‰
scp -r dist/* root@70.39.205.183:/opt/openlist/public/dist/

# æˆ–è€…ä½¿ç”¨ rsync
rsync -avz --progress dist/ root@70.39.205.183:/opt/openlist/public/dist/
```

### 3. åœ¨æœåŠ¡å™¨ä¸Šå¯åŠ¨åŽç«¯

åˆ›å»ºè‡ªå®šä¹‰çš„ docker-compose.ymlï¼š

```yaml
services:
  openlist:
    restart: always
    volumes:
      - './data:/opt/openlist/data'
      - './public:/opt/openlist/public'  # æŒ‚è½½è‡ªå®šä¹‰å‰ç«¯
    ports:
      - '5244:5244'
      - '5245:5245'
    user: '0:0'
    environment:
      - UMASK=022
      - TZ=Asia/Shanghai
    container_name: openlist
    image: 'openlistteam/openlist:latest'
```

---

## æ–¹æ¡ˆä¸‰ï¼šå®Œæ•´æ‰‹åŠ¨ç¼–è¯‘éƒ¨ç½²

### 1. åœ¨æœåŠ¡å™¨ä¸Šå®‰è£…ä¾èµ–

```bash
# å®‰è£… Goï¼ˆåŽç«¯éœ€è¦ï¼‰
wget https://go.dev/dl/go1.21.0.linux-amd64.tar.gz
tar -C /usr/local -xzf go1.21.0.linux-amd64.tar.gz
echo 'export PATH=$PATH:/usr/local/go/bin' >> ~/.bashrc
source ~/.bashrc

# å®‰è£… Node.js å’Œ pnpmï¼ˆå‰ç«¯éœ€è¦ï¼‰
curl -fsSL https://deb.nodesource.com/setup_20.x | bash -
apt-get install -y nodejs
npm install -g pnpm
```

### 2. ä¸Šä¼ ä»£ç åˆ°æœåŠ¡å™¨

```bash
# åœ¨æœ¬åœ°æ‰§è¡Œï¼Œä¸Šä¼ æ•´ä¸ªé¡¹ç›®
cd D:\SoftwareDevelopment\Project\openList__Tag_Synchronization
tar -czf openlist-project.tar.gz OpenList-Frontend-main OpenList-main

scp openlist-project.tar.gz root@70.39.205.183:/opt/

# åœ¨æœåŠ¡å™¨ä¸Šè§£åŽ‹
ssh root@70.39.205.183
cd /opt
tar -xzf openlist-project.tar.gz
```

### 3. ç¼–è¯‘å‰ç«¯

```bash
cd /opt/OpenList-Frontend-main
pnpm install
pnpm build
```

### 4. ç¼–è¯‘åŽç«¯

```bash
cd /opt/OpenList-main

# å¤åˆ¶å‰ç«¯ç¼–è¯‘äº§ç‰©åˆ°åŽç«¯çš„ public ç›®å½•
rm -rf public/dist/*
cp -r ../OpenList-Frontend-main/dist/* public/dist/

# ç¼–è¯‘åŽç«¯
bash build.sh release
```

### 5. åˆ›å»ºç³»ç»ŸæœåŠ¡

```bash
cat > /etc/systemd/system/openlist.service << 'EOF'
[Unit]
Description=OpenList Service
After=network.target

[Service]
Type=simple
User=root
WorkingDirectory=/opt/OpenList-main
ExecStart=/opt/OpenList-main/bin/openlist server
Restart=on-failure
RestartSec=10s

[Install]
WantedBy=multi-user.target
EOF
```

### 6. å¯åŠ¨æœåŠ¡

```bash
systemctl daemon-reload
systemctl enable openlist
systemctl start openlist
systemctl status openlist
```

---

## æ–¹æ¡ˆå››ï¼šä½¿ç”¨ Nginx åå‘ä»£ç†ï¼ˆå¯é€‰ï¼‰

å¦‚æžœæƒ³ä½¿ç”¨åŸŸåæˆ– 80/443 ç«¯å£ï¼Œå¯ä»¥é…ç½® Nginxï¼š

### 1. å®‰è£… Nginx

```bash
apt-get update
apt-get install -y nginx
```

### 2. åˆ›å»º Nginx é…ç½®

```bash
cat > /etc/nginx/sites-available/openlist << 'EOF'
server {
    listen 80;
    server_name 70.39.205.183;  # æˆ–è€…ä½ çš„åŸŸå

    client_max_body_size 1G;

    location / {
        proxy_pass http://localhost:5244;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        
        # WebSocket æ”¯æŒ
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
    }
}
EOF

# å¯ç”¨é…ç½®
ln -s /etc/nginx/sites-available/openlist /etc/nginx/sites-enabled/
nginx -t
systemctl reload nginx
```

---

## å¸¸ç”¨ç®¡ç†å‘½ä»¤

### Docker éƒ¨ç½²ç®¡ç†

```bash
# æŸ¥çœ‹æ—¥å¿—
docker logs -f openlist

# é‡å¯æœåŠ¡
docker restart openlist

# åœæ­¢æœåŠ¡
docker stop openlist

# å¯åŠ¨æœåŠ¡
docker start openlist

# æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬
docker-compose pull
docker-compose up -d

# å¤‡ä»½æ•°æ®
tar -czf openlist-backup-$(date +%Y%m%d).tar.gz /opt/openlist/data
```

### ç³»ç»ŸæœåŠ¡ç®¡ç†

```bash
# æŸ¥çœ‹æ—¥å¿—
journalctl -u openlist -f

# é‡å¯æœåŠ¡
systemctl restart openlist

# åœæ­¢æœåŠ¡
systemctl stop openlist

# æŸ¥çœ‹çŠ¶æ€
systemctl status openlist
```

---

## æ•°æ®å¤‡ä»½å»ºè®®

é‡è¦æ•°æ®å­˜å‚¨åœ¨ `data` ç›®å½•ä¸­ï¼Œå»ºè®®å®šæœŸå¤‡ä»½ï¼š

```bash
# åˆ›å»ºå¤‡ä»½è„šæœ¬
cat > /opt/backup-openlist.sh << 'EOF'
#!/bin/bash
BACKUP_DIR="/opt/backups"
DATE=$(date +%Y%m%d_%H%M%S)
mkdir -p $BACKUP_DIR

# å¤‡ä»½æ•°æ®
tar -czf $BACKUP_DIR/openlist-data-$DATE.tar.gz /opt/openlist/data

# åªä¿ç•™æœ€è¿‘7å¤©çš„å¤‡ä»½
find $BACKUP_DIR -name "openlist-data-*.tar.gz" -mtime +7 -delete

echo "Backup completed: openlist-data-$DATE.tar.gz"
EOF

chmod +x /opt/backup-openlist.sh

# æ·»åŠ åˆ°å®šæ—¶ä»»åŠ¡ï¼ˆæ¯å¤©å‡Œæ™¨2ç‚¹å¤‡ä»½ï¼‰
crontab -e
# æ·»åŠ ä»¥ä¸‹è¡Œï¼š
# 0 2 * * * /opt/backup-openlist.sh
```

---

## æ•…éšœæŽ’æŸ¥

### 1. æ— æ³•è®¿é—®æœåŠ¡

```bash
# æ£€æŸ¥æœåŠ¡æ˜¯å¦è¿è¡Œ
docker ps  # Docker æ–¹å¼
systemctl status openlist  # ç³»ç»ŸæœåŠ¡æ–¹å¼

# æ£€æŸ¥ç«¯å£ç›‘å¬
netstat -tlnp | grep 5244
ss -tlnp | grep 5244

# æ£€æŸ¥é˜²ç«å¢™
iptables -L -n | grep 5244
```

### 2. æŸ¥çœ‹è¯¦ç»†æ—¥å¿—

```bash
# Docker æ–¹å¼
docker logs --tail 100 openlist

# ç³»ç»ŸæœåŠ¡æ–¹å¼
journalctl -u openlist -n 100 --no-pager
```

### 3. æ•°æ®åº“é—®é¢˜

æ•°æ®åº“æ–‡ä»¶ä½äºŽ `data/data.db`ï¼Œå¦‚æžœæŸåå¯ä»¥å°è¯•ï¼š

```bash
# åœæ­¢æœåŠ¡
docker stop openlist

# æ¢å¤å¤‡ä»½
cd /opt/openlist/data
cp data.db data.db.broken
cp /path/to/backup/data.db ./

# é‡å¯æœåŠ¡
docker start openlist
```

---

## æŽ¨èéƒ¨ç½²æ–¹æ¡ˆ

**å¯¹äºŽä½ çš„æƒ…å†µï¼Œæˆ‘æŽ¨èï¼š**

1. **å¦‚æžœåªéœ€è¦å¿«é€Ÿéƒ¨ç½²**ï¼šä½¿ç”¨ **æ–¹æ¡ˆä¸€ï¼ˆDocker éƒ¨ç½²ï¼‰**
   - æœ€ç®€å•ã€æœ€å¿«é€Ÿ
   - æ˜“äºŽç»´æŠ¤å’Œæ›´æ–°
   
2. **å¦‚æžœéœ€è¦ä½¿ç”¨ä½ ä¿®æ”¹åŽçš„å‰ç«¯**ï¼šä½¿ç”¨ **æ–¹æ¡ˆäºŒ**
   - ç»“åˆäº†è‡ªå®šä¹‰å‰ç«¯å’Œ Docker åŽç«¯çš„ä¼˜åŠ¿
   - å‰ç«¯å¯ä»¥éšæ—¶é‡æ–°ç¼–è¯‘ä¸Šä¼ 

3. **å¦‚æžœéœ€è¦å®Œå…¨æŽ§åˆ¶**ï¼šä½¿ç”¨ **æ–¹æ¡ˆä¸‰**
   - é€‚åˆéœ€è¦æ·±åº¦å®šåˆ¶çš„åœºæ™¯
   - éœ€è¦æ›´å¤šçš„ç»´æŠ¤å·¥ä½œ

4. **å¦‚æžœéœ€è¦ä½¿ç”¨åŸŸåæˆ– SSL**ï¼šåœ¨ä»»ä½•æ–¹æ¡ˆåŸºç¡€ä¸ŠåŠ ä¸Š **æ–¹æ¡ˆå››**
   - æä¾›æ›´ä¸“ä¸šçš„è®¿é—®æ–¹å¼
   - æ”¯æŒ HTTPSï¼ˆéœ€è¦é…ç½® SSL è¯ä¹¦ï¼‰

---

## å®‰å…¨å»ºè®®

1. **ç«‹å³ä¿®æ”¹é»˜è®¤å¯†ç **
2. **å¯ç”¨é˜²ç«å¢™**ï¼Œåªå¼€æ”¾å¿…è¦ç«¯å£
3. **å®šæœŸæ›´æ–°ç³»ç»Ÿå’Œåº”ç”¨**
4. **é…ç½® SSL è¯ä¹¦**ï¼ˆå¦‚æžœä½¿ç”¨åŸŸåï¼‰
5. **å®šæœŸå¤‡ä»½æ•°æ®**
6. **ç›‘æŽ§æœåŠ¡è¿è¡ŒçŠ¶æ€**

---

## éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æžœéƒ¨ç½²è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œå¯ä»¥ï¼š
1. æŸ¥çœ‹ OpenList å®˜æ–¹æ–‡æ¡£: https://doc.oplist.org.cn
2. åŠ å…¥ Telegram äº¤æµç¾¤: https://t.me/OpenListTeam
3. æŸ¥çœ‹ GitHub Issues: https://github.com/OpenListTeam/OpenList/issues

ç¥éƒ¨ç½²é¡ºåˆ©ï¼ðŸŽ‰

